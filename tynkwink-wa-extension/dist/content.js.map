{
  "version": 3,
  "sources": ["../src/ui/overlay.ts", "../src/content.ts"],
  "sourcesContent": ["type OverlayOpts = {\n  onSync: () => Promise<any>;\n  onCheckAuth: () => Promise<any>;\n  onLogin: (payload: { email: string; password: string; tenantId?: string | null }) => Promise<any>;\n  onGetSummary: () => Promise<any>;\n  onGetChatSnapshot: () => { name: string | null; phone: string | null };\n};\n\nfunction el<K extends keyof HTMLElementTagNameMap>(tag: K, attrs: Record<string, string> = {}) {\n  const node = document.createElement(tag);\n  for (const [k, v] of Object.entries(attrs)) node.setAttribute(k, v);\n  return node;\n}\n\nexport function mountOverlay(opts: OverlayOpts) {\n  const id = \"tw-wa-overlay-root\";\n  if (document.getElementById(id)) return;\n\n  document.documentElement.classList.add(\"tw-wa-overlay-active\");\n  if (document.body) {\n    document.body.classList.add(\"tw-wa-overlay-active\");\n  }\n\n  const root = el(\"div\");\n  root.id = id;\n  root.style.position = \"fixed\";\n  root.style.inset = \"0\";\n  root.style.zIndex = \"999999\";\n  root.style.pointerEvents = \"none\";\n  root.style.fontFamily = \"system-ui, -apple-system, Segoe UI, Roboto, Arial\";\n\n  root.innerHTML = `\n    <style>\n      :root {\n        --tw-wa-panel-width: 360px;\n        --tw-wa-topbar-height: 54px;\n        --tw-wa-pipeline-height: 52px;\n      }\n      body.tw-wa-overlay-active {\n        padding-top: calc(var(--tw-wa-topbar-height) + var(--tw-wa-pipeline-height));\n        padding-right: var(--tw-wa-panel-effective-width);\n        box-sizing: border-box;\n      }\n      body.tw-wa-overlay-active.tw-wa-panel-collapsed {\n        padding-right: 0;\n      }\n      body.tw-wa-overlay-active header {\n        top: calc(var(--tw-wa-topbar-height) + var(--tw-wa-pipeline-height));\n      }\n      body.tw-wa-overlay-active main {\n        top: calc(var(--tw-wa-topbar-height) + var(--tw-wa-pipeline-height));\n        height: calc(100% - var(--tw-wa-topbar-height) - var(--tw-wa-pipeline-height));\n      }\n      body.tw-wa-overlay-active #app {\n        min-height: calc(100vh - var(--tw-wa-topbar-height) - var(--tw-wa-pipeline-height));\n        box-sizing: border-box;\n      }\n      @media (max-width: 1280px) {\n        :root {\n          --tw-wa-panel-width: 320px;\n        }\n      }\n      #tw-wa-overlay-root {\n        --tw-wa-app-left: 0px;\n        --tw-wa-app-top: 0px;\n        --tw-wa-app-right: 0px;\n        --tw-wa-app-bottom: 0px;\n        --tw-wa-app-width: 100vw;\n        --tw-wa-app-height: 100vh;\n        --tw-wa-panel-effective-width: var(--tw-wa-panel-width);\n      }\n      .tw-wa-topbar {\n        position: fixed;\n        top: var(--tw-wa-app-top);\n        left: var(--tw-wa-app-left);\n        right: var(--tw-wa-app-right);\n        height: var(--tw-wa-topbar-height);\n        background: linear-gradient(180deg, #111, #1b1b1b);\n        border-bottom: 1px solid rgba(255,255,255,0.08);\n        display: flex;\n        align-items: center;\n        padding: 0 16px;\n        gap: 18px;\n        color: #e6f0ff;\n        pointer-events: auto;\n      }\n      .tw-wa-logo {\n        font-weight: 800;\n        letter-spacing: 0.4px;\n        color: #5cc1ff;\n        display: flex;\n        align-items: center;\n        gap: 8px;\n      }\n      .tw-wa-nav {\n        display: flex;\n        gap: 12px;\n        font-size: 13px;\n        align-items: center;\n        color: #9fd3ff;\n      }\n      .tw-wa-nav span {\n        opacity: 0.9;\n        cursor: pointer;\n      }\n      .tw-wa-actions {\n        margin-left: auto;\n        display: flex;\n        align-items: center;\n        gap: 10px;\n      }\n      .tw-wa-icon-button {\n        width: 34px;\n        height: 34px;\n        border-radius: 10px;\n        border: 1px solid rgba(255,255,255,0.12);\n        background: rgba(18, 22, 30, 0.7);\n        color: #9fd3ff;\n        display: flex;\n        align-items: center;\n        justify-content: center;\n        cursor: pointer;\n      }\n      .tw-wa-icon-button svg {\n        width: 18px;\n        height: 18px;\n        fill: currentColor;\n      }\n      .tw-wa-pill {\n        border: 1px solid rgba(96, 181, 255, 0.6);\n        color: #e3f1ff;\n        padding: 6px 12px;\n        border-radius: 999px;\n        font-size: 12px;\n        background: rgba(10, 27, 41, 0.6);\n        cursor: pointer;\n      }\n      .tw-wa-auth-status {\n        font-size: 12px;\n        color: #9ac7ff;\n      }\n      .tw-wa-pipeline {\n        position: fixed;\n        top: calc(var(--tw-wa-app-top) + var(--tw-wa-topbar-height));\n        left: var(--tw-wa-app-left);\n        right: calc(var(--tw-wa-panel-effective-width) + var(--tw-wa-app-right));\n        height: var(--tw-wa-pipeline-height);\n        display: grid;\n        grid-template-columns: repeat(7, 1fr);\n        gap: 2px;\n        padding: 6px 10px;\n        background: #121212;\n        pointer-events: auto;\n      }\n      .tw-wa-stage {\n        display: flex;\n        flex-direction: column;\n        justify-content: center;\n        align-items: center;\n        color: #fff;\n        font-size: 12px;\n        border-radius: 10px;\n        position: relative;\n        padding: 6px 0;\n      }\n      .tw-wa-stage strong {\n        font-size: 16px;\n      }\n      .tw-wa-panel {\n        position: fixed;\n        top: calc(var(--tw-wa-app-top) + var(--tw-wa-topbar-height));\n        right: var(--tw-wa-app-right);\n        width: var(--tw-wa-panel-effective-width);\n        bottom: var(--tw-wa-app-bottom);\n        background: #151515;\n        border-left: 1px solid rgba(255,255,255,0.08);\n        color: #e9f2ff;\n        display: flex;\n        flex-direction: column;\n        pointer-events: auto;\n        transition: transform 0.25s ease;\n      }\n      #tw-wa-overlay-root.tw-wa-panel-collapsed .tw-wa-panel {\n        transform: translateX(100%);\n      }\n      .tw-wa-panel-tabs {\n        display: grid;\n        grid-template-columns: repeat(4, 1fr);\n        border-bottom: 1px solid rgba(255,255,255,0.08);\n        background: #101214;\n      }\n      .tw-wa-tab {\n        height: 48px;\n        display: flex;\n        align-items: center;\n        justify-content: center;\n        color: #9aa7b6;\n        border: none;\n        background: transparent;\n        cursor: pointer;\n        position: relative;\n      }\n      .tw-wa-tab svg {\n        width: 20px;\n        height: 20px;\n        fill: currentColor;\n      }\n      .tw-wa-tab.is-active {\n        color: #5cc1ff;\n      }\n      .tw-wa-tab.is-active::after {\n        content: \"\";\n        position: absolute;\n        bottom: 0;\n        left: 0;\n        right: 0;\n        height: 3px;\n        background: #2a8bf2;\n      }\n      .tw-wa-panel-body {\n        padding: 16px;\n        display: flex;\n        flex-direction: column;\n        gap: 18px;\n        overflow-y: auto;\n        height: 100%;\n      }\n      .tw-wa-tab-panel {\n        display: none;\n        flex-direction: column;\n        gap: 16px;\n      }\n      .tw-wa-tab-panel.is-active {\n        display: flex;\n      }\n      .tw-wa-section {\n        background: #131516;\n        border: 1px solid rgba(255,255,255,0.06);\n        border-radius: 12px;\n        padding: 12px;\n        display: flex;\n        flex-direction: column;\n        gap: 12px;\n      }\n      .tw-wa-section-header {\n        display: flex;\n        align-items: center;\n        justify-content: space-between;\n        font-size: 15px;\n        font-weight: 600;\n        color: #f1f5ff;\n      }\n      .tw-wa-section-header button {\n        background: transparent;\n        border: none;\n        color: #7da9ff;\n        cursor: pointer;\n      }\n      .tw-wa-field {\n        display: grid;\n        grid-template-columns: 90px 1fr;\n        gap: 10px;\n        align-items: center;\n        font-size: 12px;\n        color: #9aa7b6;\n      }\n      .tw-wa-field label {\n        color: #e0e6f0;\n      }\n      .tw-wa-field.tw-wa-field-stack {\n        grid-template-columns: 1fr;\n        gap: 8px;\n        align-items: start;\n      }\n      .tw-wa-input,\n      .tw-wa-select,\n      .tw-wa-textarea {\n        background: #1b1f24;\n        border: 1px solid rgba(255,255,255,0.1);\n        border-radius: 8px;\n        padding: 8px 10px;\n        color: #f3f7ff;\n        font-size: 13px;\n        width: 100%;\n      }\n      .tw-wa-textarea {\n        min-height: 90px;\n        resize: vertical;\n      }\n      .tw-wa-input[readonly] {\n        opacity: 0.85;\n      }\n      .tw-wa-inline {\n        display: flex;\n        gap: 10px;\n        align-items: center;\n      }\n      .tw-wa-switch {\n        position: relative;\n        width: 44px;\n        height: 24px;\n      }\n      .tw-wa-switch input {\n        opacity: 0;\n        width: 0;\n        height: 0;\n      }\n      .tw-wa-slider {\n        position: absolute;\n        inset: 0;\n        background: #2b3138;\n        border-radius: 999px;\n        transition: 0.2s ease;\n      }\n      .tw-wa-slider::before {\n        content: \"\";\n        position: absolute;\n        height: 18px;\n        width: 18px;\n        left: 3px;\n        top: 3px;\n        background: #cbd5f5;\n        border-radius: 999px;\n        transition: 0.2s ease;\n      }\n      .tw-wa-switch input:checked + .tw-wa-slider {\n        background: #17a861;\n      }\n      .tw-wa-switch input:checked + .tw-wa-slider::before {\n        transform: translateX(20px);\n        background: #fff;\n      }\n      .tw-wa-link {\n        color: #4aa3ff;\n        font-size: 12px;\n        cursor: pointer;\n      }\n      .tw-wa-divider {\n        height: 1px;\n        background: rgba(255,255,255,0.08);\n      }\n      .tw-wa-sync {\n        width: 100%;\n        background: #1c5aa6;\n        border: none;\n        color: #fff;\n        padding: 10px 12px;\n        border-radius: 10px;\n        font-weight: 600;\n        cursor: pointer;\n      }\n      .tw-wa-log {\n        background: #101214;\n        border: 1px solid rgba(255,255,255,0.08);\n        border-radius: 10px;\n        padding: 10px;\n        font-size: 11px;\n        max-height: 140px;\n        overflow: auto;\n        white-space: pre-wrap;\n        color: #a4b0c0;\n      }\n      .tw-wa-quick-actions {\n        display: flex;\n        align-items: center;\n        justify-content: space-between;\n      }\n      .tw-wa-btn-secondary {\n        border: 1px solid rgba(70, 130, 255, 0.6);\n        background: transparent;\n        color: #7da9ff;\n        padding: 6px 10px;\n        border-radius: 8px;\n        cursor: pointer;\n        font-size: 12px;\n      }\n      .tw-wa-btn-primary {\n        border: none;\n        background: #1c5aa6;\n        color: #fff;\n        padding: 8px 12px;\n        border-radius: 8px;\n        cursor: pointer;\n        font-size: 12px;\n        font-weight: 600;\n      }\n      .tw-wa-btn-primary[disabled],\n      .tw-wa-btn-secondary[disabled] {\n        opacity: 0.6;\n        cursor: not-allowed;\n      }\n      .tw-wa-lead-status {\n        background: rgba(17, 20, 25, 0.7);\n        border: 1px solid rgba(255,255,255,0.08);\n        border-radius: 10px;\n        padding: 10px;\n        display: flex;\n        flex-direction: column;\n        gap: 8px;\n      }\n      .tw-wa-lead-status-header {\n        display: flex;\n        align-items: center;\n        justify-content: space-between;\n        font-size: 12px;\n        color: #e0e6f0;\n      }\n      .tw-wa-status-pill {\n        font-size: 11px;\n        padding: 4px 8px;\n        border-radius: 999px;\n        background: rgba(59, 130, 246, 0.15);\n        color: #93c5fd;\n        border: 1px solid rgba(59, 130, 246, 0.4);\n      }\n      .tw-wa-status-pill.is-success {\n        background: rgba(22, 163, 74, 0.15);\n        color: #86efac;\n        border-color: rgba(22, 163, 74, 0.5);\n      }\n      .tw-wa-status-pill.is-warning {\n        background: rgba(234, 179, 8, 0.15);\n        color: #fde68a;\n        border-color: rgba(234, 179, 8, 0.5);\n      }\n      .tw-wa-status-body {\n        font-size: 12px;\n        color: #b3bfce;\n        line-height: 1.4;\n      }\n      .tw-wa-status-actions {\n        display: flex;\n        gap: 8px;\n        flex-wrap: wrap;\n      }\n      .tw-wa-reminder-list,\n      .tw-wa-quick-list {\n        display: flex;\n        flex-direction: column;\n        gap: 10px;\n      }\n      .tw-wa-reminder-item,\n      .tw-wa-quick-item {\n        display: flex;\n        align-items: center;\n        gap: 10px;\n        padding: 8px 10px;\n        background: #181c21;\n        border-radius: 8px;\n        border: 1px solid rgba(255,255,255,0.06);\n      }\n      .tw-wa-reminder-item label {\n        flex: 1;\n        color: #e1e7f4;\n        font-size: 13px;\n      }\n      .tw-wa-count-pill {\n        background: #1f2937;\n        border-radius: 999px;\n        padding: 2px 8px;\n        font-size: 12px;\n        color: #8fa3bf;\n      }\n      .tw-wa-empty {\n        font-size: 12px;\n        color: #8a97ab;\n        padding: 8px 0;\n      }\n      .tw-wa-collapsible-toggle {\n        display: flex;\n        align-items: center;\n        justify-content: space-between;\n        gap: 8px;\n        cursor: pointer;\n        border: none;\n        background: transparent;\n        color: inherit;\n        padding: 0;\n      }\n      .tw-wa-collapsible-toggle svg {\n        width: 16px;\n        height: 16px;\n        transition: transform 0.2s ease;\n      }\n      .tw-wa-collapsible-toggle[aria-expanded=\"false\"] svg {\n        transform: rotate(-90deg);\n      }\n      .tw-wa-collapsible-content {\n        display: none;\n        flex-direction: column;\n        gap: 10px;\n      }\n      .tw-wa-collapsible-content.is-open {\n        display: flex;\n      }\n      .tw-wa-modal {\n        position: fixed;\n        inset: 0;\n        background: rgba(0,0,0,0.72);\n        display: none;\n        align-items: center;\n        justify-content: center;\n        pointer-events: auto;\n      }\n      .tw-wa-modal.is-visible {\n        display: flex;\n      }\n      .tw-wa-modal-card {\n        width: 420px;\n        background: #141516;\n        border: 1px solid rgba(255,255,255,0.08);\n        border-radius: 16px;\n        padding: 22px;\n        color: #f4f7ff;\n        box-shadow: 0 24px 60px rgba(0,0,0,0.4);\n        position: relative;\n      }\n      .tw-wa-modal-card h2 {\n        margin: 8px 0 4px;\n        text-align: center;\n      }\n      .tw-wa-modal-card p {\n        margin: 0 0 16px;\n        text-align: center;\n        color: #a4b0c0;\n        font-size: 13px;\n      }\n      .tw-wa-modal-field {\n        margin-top: 12px;\n        display: flex;\n        flex-direction: column;\n        gap: 6px;\n        font-size: 12px;\n        color: #9aa7b6;\n      }\n      .tw-wa-modal-actions {\n        margin-top: 16px;\n        display: flex;\n        flex-direction: column;\n        gap: 8px;\n      }\n      .tw-wa-modal-actions button {\n        padding: 10px 12px;\n        border-radius: 10px;\n        border: none;\n        cursor: pointer;\n        font-weight: 600;\n      }\n      .tw-wa-primary {\n        background: #1c5aa6;\n        color: #fff;\n      }\n      .tw-wa-link-alt {\n        background: transparent;\n        color: #4aa3ff;\n        border: none;\n        text-decoration: underline;\n        cursor: pointer;\n      }\n      .tw-wa-modal-status {\n        margin-top: 10px;\n        font-size: 12px;\n        color: #9ac7ff;\n        text-align: center;\n      }\n      .tw-wa-close {\n        position: absolute;\n        top: 14px;\n        right: 16px;\n        background: transparent;\n        border: none;\n        color: #fff;\n        font-size: 18px;\n        cursor: pointer;\n      }\n    </style>\n    <div class=\"tw-wa-topbar\">\n      <div class=\"tw-wa-logo\">Tynkwink CRM</div>\n      <div class=\"tw-wa-nav\">\n        <span data-role=\"nav-all\">All Chats (\u2014)</span>\n        <span data-role=\"nav-unread\">Unread Chats (\u2014)</span>\n        <span data-role=\"nav-needs-reply\">Needs Reply (\u2014)</span>\n        <span data-role=\"nav-groups\">Groups (\u2014)</span>\n        <span data-role=\"nav-reminders\">Pending Reminders (\u2014)</span>\n      </div>\n      <div class=\"tw-wa-actions\">\n        <button\n          class=\"tw-wa-icon-button\"\n          type=\"button\"\n          data-action=\"toggle-panel\"\n          aria-expanded=\"true\"\n          title=\"Toggle panel\"\n        >\n          <svg viewBox=\"0 0 24 24\" aria-hidden=\"true\"><path d=\"M3 6h18v2H3V6zm0 5h18v2H3v-2zm0 5h18v2H3v-2z\"/></svg>\n        </button>\n        <span class=\"tw-wa-auth-status\">Checking CRM login...</span>\n        <button class=\"tw-wa-pill\" data-action=\"login\">Login</button>\n        <button class=\"tw-wa-pill\" data-action=\"sync\">Sync Chat</button>\n      </div>\n    </div>\n    <div class=\"tw-wa-pipeline\" data-role=\"pipeline\"></div>\n    <div class=\"tw-wa-panel\">\n      <div class=\"tw-wa-panel-tabs\" role=\"tablist\">\n        <button class=\"tw-wa-tab is-active\" data-tab=\"personal\" role=\"tab\" aria-selected=\"true\">\n          <svg viewBox=\"0 0 24 24\" aria-hidden=\"true\"><path d=\"M12 12c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zm0 2c-3.33 0-10 1.67-10 5v3h20v-3c0-3.33-6.67-5-10-5z\"/></svg>\n        </button>\n        <button class=\"tw-wa-tab\" data-tab=\"call\" role=\"tab\" aria-selected=\"false\">\n          <svg viewBox=\"0 0 24 24\" aria-hidden=\"true\"><path d=\"M6.62 10.79a15.05 15.05 0 006.59 6.59l2.2-2.2c.27-.27.67-.36 1.02-.24 1.12.37 2.33.57 3.57.57.55 0 1 .45 1 1v3.5c0 .55-.45 1-1 1C10.07 21.51 2.5 13.94 2.5 4.5c0-.55.45-1 1-1H7c.55 0 1 .45 1 1 0 1.24.2 2.45.57 3.57.11.35.03.74-.25 1.02l-2.7 2.7z\"/></svg>\n        </button>\n        <button class=\"tw-wa-tab\" data-tab=\"quick\" role=\"tab\" aria-selected=\"false\">\n          <svg viewBox=\"0 0 24 24\" aria-hidden=\"true\"><path d=\"M20 2H4c-1.1 0-2 .9-2 2v14l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2z\"/></svg>\n        </button>\n        <button class=\"tw-wa-tab\" data-tab=\"assistant\" role=\"tab\" aria-selected=\"false\">\n          <svg viewBox=\"0 0 24 24\" aria-hidden=\"true\"><path d=\"M12 2a7 7 0 00-7 7v5H4a2 2 0 00-2 2v2a2 2 0 002 2h2v-9a6 6 0 0112 0v9h2a2 2 0 002-2v-2a2 2 0 00-2-2h-1V9a7 7 0 00-7-7z\"/></svg>\n        </button>\n      </div>\n      <div class=\"tw-wa-panel-body\">\n        <section class=\"tw-wa-tab-panel is-active\" data-panel=\"personal\">\n          <div class=\"tw-wa-section\">\n            <div class=\"tw-wa-section-header\">\n              <span>Personal Info</span>\n              <button type=\"button\" title=\"Edit\">\u270E</button>\n            </div>\n            <div class=\"tw-wa-field\">\n              <label>Name</label>\n              <input class=\"tw-wa-input\" data-role=\"contact-name\" placeholder=\"Lead name\" />\n            </div>\n            <div class=\"tw-wa-field\">\n              <label>Phone</label>\n              <div class=\"tw-wa-inline\">\n                <input class=\"tw-wa-input\" data-role=\"contact-phone\" placeholder=\"Phone number\" />\n                <button class=\"tw-wa-btn-secondary\" data-action=\"copy-phone\">Copy</button>\n              </div>\n            </div>\n            <div class=\"tw-wa-field tw-wa-field-stack\">\n              <div class=\"tw-wa-lead-status\">\n                <div class=\"tw-wa-lead-status-header\">\n                  <span>Lead Status</span>\n                  <span class=\"tw-wa-status-pill\" data-role=\"lead-status-pill\">Checking</span>\n                </div>\n                <div class=\"tw-wa-status-body\" data-role=\"lead-status-body\">\n                  Waiting for chat details...\n                </div>\n                <div class=\"tw-wa-status-actions\" data-role=\"lead-status-actions\">\n                  <button class=\"tw-wa-btn-primary\" type=\"button\" data-action=\"create-lead\">Create Lead</button>\n                  <button class=\"tw-wa-btn-secondary\" type=\"button\" data-action=\"send-inbox\">\n                    Send to Lead Inbox\n                  </button>\n                </div>\n              </div>\n            </div>\n            <div class=\"tw-wa-field\">\n              <label>AI Auto-Reply</label>\n              <div class=\"tw-wa-inline\" style=\"justify-content:space-between;\">\n                <span data-role=\"ai-label\">(Global Switch: --)</span>\n                <label class=\"tw-wa-switch\">\n                  <input type=\"checkbox\" data-role=\"ai-toggle\" disabled />\n                  <span class=\"tw-wa-slider\"></span>\n                </label>\n              </div>\n            </div>\n            <div class=\"tw-wa-field\">\n              <label>Pipeline</label>\n              <input class=\"tw-wa-input\" data-role=\"pipeline-name\" readonly />\n            </div>\n            <div class=\"tw-wa-field\">\n              <label>Stage</label>\n              <select class=\"tw-wa-select\" data-role=\"stage-select\"></select>\n            </div>\n            <div class=\"tw-wa-field\">\n              <label>Sequence</label>\n              <span class=\"tw-wa-link\" data-role=\"sequence\">No Sequence</span>\n            </div>\n            <div class=\"tw-wa-field\">\n              <label>Source</label>\n              <input class=\"tw-wa-input\" data-role=\"source-name\" readonly />\n            </div>\n          </div>\n          <div class=\"tw-wa-section\">\n            <button\n              class=\"tw-wa-collapsible-toggle\"\n              data-action=\"toggle-additional\"\n              aria-expanded=\"false\"\n              aria-controls=\"tw-wa-additional-info\"\n              type=\"button\"\n            >\n              <span class=\"tw-wa-section-header\">Additional Info</span>\n              <svg viewBox=\"0 0 24 24\" aria-hidden=\"true\"><path fill=\"currentColor\" d=\"M7 10l5 5 5-5z\"/></svg>\n            </button>\n            <div\n              class=\"tw-wa-collapsible-content\"\n              data-role=\"additional-content\"\n              id=\"tw-wa-additional-info\"\n              hidden\n            >\n              <div class=\"tw-wa-field\">\n                <label>Email</label>\n                <input class=\"tw-wa-input\" data-role=\"contact-email\" placeholder=\"Enter the Email\" />\n              </div>\n              <div class=\"tw-wa-field\">\n                <label>Company</label>\n                <input class=\"tw-wa-input\" data-role=\"contact-company\" placeholder=\"Company\" />\n              </div>\n              <div class=\"tw-wa-field\">\n                <label>Created</label>\n                <input class=\"tw-wa-input\" data-role=\"contact-created\" readonly />\n              </div>\n              <button class=\"tw-wa-btn-secondary\" type=\"button\">+ Add New Attribute</button>\n            </div>\n          </div>\n          <div class=\"tw-wa-section\">\n            <button\n              class=\"tw-wa-collapsible-toggle\"\n              data-action=\"toggle-activity\"\n              aria-expanded=\"true\"\n              aria-controls=\"tw-wa-activity-history\"\n              type=\"button\"\n            >\n              <span class=\"tw-wa-section-header\">Activity History</span>\n              <svg viewBox=\"0 0 24 24\" aria-hidden=\"true\"><path fill=\"currentColor\" d=\"M7 10l5 5 5-5z\"/></svg>\n            </button>\n            <div\n              class=\"tw-wa-collapsible-content is-open\"\n              data-role=\"activity-content\"\n              id=\"tw-wa-activity-history\"\n            >\n              <label class=\"tw-wa-field\" style=\"grid-template-columns:1fr; gap:6px;\">\n                <span style=\"color:#9aa7b6;\">Notes</span>\n                <textarea class=\"tw-wa-textarea\" placeholder=\"Take a note for this chat.\"></textarea>\n              </label>\n            </div>\n          </div>\n          <div class=\"tw-wa-log\" data-role=\"log\"></div>\n          <button class=\"tw-wa-sync\" data-action=\"sync\">Import lead to Tynkwink CRM</button>\n        </section>\n\n        <section class=\"tw-wa-tab-panel\" data-panel=\"call\">\n          <div class=\"tw-wa-section\">\n            <div class=\"tw-wa-section-header\">\n              <span>Call Tracker</span>\n              <button class=\"tw-wa-btn-secondary\" type=\"button\">Add Reminder</button>\n            </div>\n            <div class=\"tw-wa-reminder-list\" data-role=\"reminder-list\"></div>\n          </div>\n        </section>\n\n        <section class=\"tw-wa-tab-panel\" data-panel=\"quick\">\n          <div class=\"tw-wa-section\">\n            <div class=\"tw-wa-quick-actions\">\n              <span class=\"tw-wa-section-header\">Quick Replies</span>\n              <button class=\"tw-wa-btn-secondary\" type=\"button\">+ Add a Quick Reply</button>\n            </div>\n            <div class=\"tw-wa-quick-list\" data-role=\"quick-list\"></div>\n          </div>\n        </section>\n\n        <section class=\"tw-wa-tab-panel\" data-panel=\"assistant\">\n          <div class=\"tw-wa-section\">\n            <div class=\"tw-wa-section-header\">\n              <span>AI Assistant</span>\n            </div>\n            <div class=\"tw-wa-empty\">Coming soon: AI suggestions based on your Tynkwink CRM history.</div>\n          </div>\n        </section>\n      </div>\n    </div>\n    <div class=\"tw-wa-modal\" data-role=\"modal\">\n      <div class=\"tw-wa-modal-card\">\n        <button class=\"tw-wa-close\" data-action=\"close\">\u2715</button>\n        <div class=\"tw-wa-logo\" style=\"justify-content:center; font-size:20px;\">Tynkwink</div>\n        <h2>Login</h2>\n        <p>Sign in to Tynkwink CRM to fetch your extension credentials automatically.</p>\n        <form data-role=\"login-form\">\n          <div class=\"tw-wa-modal-field\">\n            <label>Email</label>\n            <input class=\"tw-wa-input\" type=\"email\" name=\"email\" placeholder=\"Enter your email\" required />\n          </div>\n          <div class=\"tw-wa-modal-field\">\n            <label>Password</label>\n            <input class=\"tw-wa-input\" type=\"password\" name=\"password\" placeholder=\"Enter your password\" required />\n          </div>\n          <div class=\"tw-wa-modal-field\" data-role=\"tenant-field\">\n            <label>Tenant ID (optional)</label>\n            <input class=\"tw-wa-input\" type=\"text\" name=\"tenantId\" placeholder=\"workspace id or slug\" data-role=\"tenant-input\" />\n            <select class=\"tw-wa-input\" name=\"tenantId\" data-role=\"tenant-select\" style=\"display:none;\"></select>\n          </div>\n          <div class=\"tw-wa-modal-actions\">\n            <button class=\"tw-wa-primary\" type=\"submit\">Get Access</button>\n            <button class=\"tw-wa-link-alt\" type=\"button\">Forgot Password?</button>\n          </div>\n          <div class=\"tw-wa-modal-status\" data-role=\"modal-status\"></div>\n        </form>\n      </div>\n    </div>\n  `;\n\n  document.body.appendChild(root);\n\n  const authStatus = root.querySelector(\".tw-wa-auth-status\") as HTMLSpanElement;\n  const navAll = root.querySelector('[data-role=\"nav-all\"]') as HTMLSpanElement;\n  const navUnread = root.querySelector('[data-role=\"nav-unread\"]') as HTMLSpanElement;\n  const navNeedsReply = root.querySelector('[data-role=\"nav-needs-reply\"]') as HTMLSpanElement;\n  const navGroups = root.querySelector('[data-role=\"nav-groups\"]') as HTMLSpanElement;\n  const navReminders = root.querySelector('[data-role=\"nav-reminders\"]') as HTMLSpanElement;\n  const pipelineContainer = root.querySelector('[data-role=\"pipeline\"]') as HTMLDivElement;\n  const contactName = root.querySelector('[data-role=\"contact-name\"]') as HTMLInputElement;\n  const contactPhone = root.querySelector('[data-role=\"contact-phone\"]') as HTMLInputElement;\n  const contactEmail = root.querySelector('[data-role=\"contact-email\"]') as HTMLInputElement;\n  const contactCompany = root.querySelector('[data-role=\"contact-company\"]') as HTMLInputElement;\n  const contactCreated = root.querySelector('[data-role=\"contact-created\"]') as HTMLInputElement;\n  const aiLabel = root.querySelector('[data-role=\"ai-label\"]') as HTMLSpanElement;\n  const aiToggle = root.querySelector('[data-role=\"ai-toggle\"]') as HTMLInputElement;\n  const pipelineName = root.querySelector('[data-role=\"pipeline-name\"]') as HTMLInputElement;\n  const stageSelect = root.querySelector('[data-role=\"stage-select\"]') as HTMLSelectElement;\n  const sequenceLabel = root.querySelector('[data-role=\"sequence\"]') as HTMLSpanElement;\n  const sourceName = root.querySelector('[data-role=\"source-name\"]') as HTMLInputElement;\n  const leadStatusPill = root.querySelector('[data-role=\"lead-status-pill\"]') as HTMLSpanElement;\n  const leadStatusBody = root.querySelector('[data-role=\"lead-status-body\"]') as HTMLDivElement;\n  const leadStatusActions = root.querySelector('[data-role=\"lead-status-actions\"]') as HTMLDivElement;\n  const createLeadButton = root.querySelector('[data-action=\"create-lead\"]') as HTMLButtonElement;\n  const sendInboxButton = root.querySelector('[data-action=\"send-inbox\"]') as HTMLButtonElement;\n  const modal = root.querySelector('[data-role=\"modal\"]') as HTMLDivElement;\n  const modalStatus = root.querySelector('[data-role=\"modal-status\"]') as HTMLDivElement;\n  const tenantField = root.querySelector('[data-role=\"tenant-field\"]') as HTMLDivElement;\n  const tenantInput = tenantField.querySelector('[data-role=\"tenant-input\"]') as HTMLInputElement;\n  const tenantSelect = tenantField.querySelector('[data-role=\"tenant-select\"]') as HTMLSelectElement;\n  const loginForm = root.querySelector('[data-role=\"login-form\"]') as HTMLFormElement;\n  const log = root.querySelector('[data-role=\"log\"]') as HTMLDivElement;\n  const loginBtn = root.querySelector('[data-action=\"login\"]') as HTMLButtonElement;\n  const closeBtn = root.querySelector('[data-action=\"close\"]') as HTMLButtonElement;\n  const syncButtons = root.querySelectorAll('[data-action=\"sync\"]');\n  const tabButtons = Array.from(root.querySelectorAll('[data-tab]')) as HTMLButtonElement[];\n  const tabPanels = Array.from(root.querySelectorAll('[data-panel]')) as HTMLElement[];\n  const additionalToggle = root.querySelector('[data-action=\"toggle-additional\"]') as HTMLButtonElement;\n  const additionalContent = root.querySelector('[data-role=\"additional-content\"]') as HTMLDivElement;\n  const activityToggle = root.querySelector('[data-action=\"toggle-activity\"]') as HTMLButtonElement;\n  const activityContent = root.querySelector('[data-role=\"activity-content\"]') as HTMLDivElement;\n  const reminderList = root.querySelector('[data-role=\"reminder-list\"]') as HTMLDivElement;\n  const quickList = root.querySelector('[data-role=\"quick-list\"]') as HTMLDivElement;\n  const copyPhoneButton = root.querySelector('[data-action=\"copy-phone\"]') as HTMLButtonElement;\n  const panelToggleButton = root.querySelector('[data-action=\"toggle-panel\"]') as HTMLButtonElement;\n\n  let isLoggingIn = false;\n  let isLoadingSummary = false;\n  let isPanelCollapsed = false;\n  let isCheckingLead = false;\n  let lastLeadPhone: string | null = null;\n  let lastSummaryStages: Array<{ id: string; name: string }> = [];\n\n  let lastSnapshot: { name: string | null; phone: string | null } = { name: null, phone: null };\n  let headerObserver: MutationObserver | null = null;\n  let observedHeader: HTMLElement | null = null;\n\n  const getPanelWidth = () => {\n    const raw = getComputedStyle(document.documentElement).getPropertyValue(\"--tw-wa-panel-width\");\n    const parsed = Number.parseFloat(raw);\n    return Number.isFinite(parsed) ? parsed : 360;\n  };\n\n  const updateOverlayBounds = () => {\n    const appRoot = document.querySelector(\"#app\") as HTMLElement | null;\n    const rect = appRoot?.getBoundingClientRect() ?? {\n      left: 0,\n      top: 0,\n      right: window.innerWidth,\n      bottom: window.innerHeight,\n      width: window.innerWidth,\n      height: window.innerHeight,\n    };\n    const panelWidth = isPanelCollapsed ? 0 : Math.min(rect.width || window.innerWidth, getPanelWidth());\n    root.style.setProperty(\"--tw-wa-app-left\", `${rect.left}px`);\n    root.style.setProperty(\"--tw-wa-app-top\", `${rect.top}px`);\n    root.style.setProperty(\"--tw-wa-app-right\", `${Math.max(0, window.innerWidth - rect.right)}px`);\n    root.style.setProperty(\"--tw-wa-app-bottom\", `${Math.max(0, window.innerHeight - rect.bottom)}px`);\n    root.style.setProperty(\"--tw-wa-app-width\", `${rect.width || window.innerWidth}px`);\n    root.style.setProperty(\"--tw-wa-app-height\", `${rect.height || window.innerHeight}px`);\n    root.style.setProperty(\"--tw-wa-panel-effective-width\", `${panelWidth}px`);\n  };\n\n  const setPanelCollapsed = (collapsed: boolean) => {\n    isPanelCollapsed = collapsed;\n    root.classList.toggle(\"tw-wa-panel-collapsed\", collapsed);\n    document.documentElement.classList.toggle(\"tw-wa-panel-collapsed\", collapsed);\n    document.body?.classList.toggle(\"tw-wa-panel-collapsed\", collapsed);\n    panelToggleButton.setAttribute(\"aria-expanded\", String(!collapsed));\n    panelToggleButton.title = collapsed ? \"Show panel\" : \"Hide panel\";\n    updateOverlayBounds();\n  };\n\n  const updateChatSnapshot = () => {\n    const snapshot = opts.onGetChatSnapshot();\n    const nextName = snapshot?.name || null;\n    const nextPhone = snapshot?.phone || null;\n    if (nextName === lastSnapshot.name && nextPhone === lastSnapshot.phone) return;\n    lastSnapshot = { name: nextName, phone: nextPhone };\n    contactName.value = nextName || \"\";\n    contactPhone.value = nextPhone || \"\";\n    contactCreated.value = new Date().toLocaleString();\n    refreshLeadStatus();\n  };\n\n  const ensureHeaderObserver = () => {\n    const header = document.querySelector(\"header\") as HTMLElement | null;\n    if (!header || header === observedHeader) return;\n    headerObserver?.disconnect();\n    observedHeader = header;\n    headerObserver = new MutationObserver(() => updateChatSnapshot());\n    headerObserver.observe(header, { subtree: true, childList: true, characterData: true });\n    updateChatSnapshot();\n  };\n\n  const setTab = (tabId: string) => {\n    tabButtons.forEach((button) => {\n      const isActive = button.dataset.tab === tabId;\n      button.classList.toggle(\"is-active\", isActive);\n      button.setAttribute(\"aria-selected\", String(isActive));\n    });\n    tabPanels.forEach((panel) => {\n      panel.classList.toggle(\"is-active\", panel.dataset.panel === tabId);\n    });\n  };\n\n  tabButtons.forEach((button) => {\n    button.addEventListener(\"click\", () => {\n      setTab(button.dataset.tab || \"personal\");\n    });\n  });\n\n  panelToggleButton.addEventListener(\"click\", () => {\n    setPanelCollapsed(!isPanelCollapsed);\n  });\n\n  const toggleCollapsible = (toggle: HTMLButtonElement, content: HTMLElement) => {\n    const isExpanded = toggle.getAttribute(\"aria-expanded\") === \"true\";\n    const nextExpanded = !isExpanded;\n    toggle.setAttribute(\"aria-expanded\", String(nextExpanded));\n    content.classList.toggle(\"is-open\", nextExpanded);\n    content.toggleAttribute(\"hidden\", !nextExpanded);\n  };\n\n  additionalToggle.addEventListener(\"click\", () => toggleCollapsible(additionalToggle, additionalContent));\n  activityToggle.addEventListener(\"click\", () => toggleCollapsible(activityToggle, activityContent));\n\n  copyPhoneButton.addEventListener(\"click\", async () => {\n    if (!contactPhone.value) return;\n    try {\n      await navigator.clipboard.writeText(contactPhone.value);\n      copyPhoneButton.textContent = \"Copied\";\n      setTimeout(() => {\n        copyPhoneButton.textContent = \"Copy\";\n      }, 1200);\n    } catch {\n      copyPhoneButton.textContent = \"Unable\";\n    }\n  });\n\n  contactPhone.addEventListener(\"change\", () => {\n    refreshLeadStatus();\n  });\n\n  createLeadButton.addEventListener(\"click\", async () => {\n    const name = contactName.value.trim() || \"WhatsApp Lead\";\n    const phone = contactPhone.value.trim();\n    if (!phone) {\n      setLeadStatus({\n        status: \"error\",\n        message: \"Phone number is required to create a lead.\",\n        showActions: true,\n      });\n      return;\n    }\n    createLeadButton.disabled = true;\n    sendInboxButton.disabled = true;\n    setLeadStatus({ status: \"checking\", message: \"Creating lead in CRM...\", showActions: false });\n    const payload = {\n      name,\n      phone,\n      email: contactEmail.value.trim() || undefined,\n      company: contactCompany.value.trim() || undefined,\n      stageId: stageSelect.value || undefined,\n    };\n    const res = await chrome.runtime.sendMessage({ type: \"CREATE_LEAD\", payload });\n    if (!res?.ok) {\n      setLeadStatus({\n        status: \"error\",\n        message: res?.error || \"Unable to create lead.\",\n        showActions: true,\n      });\n      createLeadButton.disabled = false;\n      sendInboxButton.disabled = false;\n      return;\n    }\n    await refreshSummary();\n    createLeadButton.disabled = false;\n    sendInboxButton.disabled = false;\n  });\n\n  sendInboxButton.addEventListener(\"click\", async () => {\n    const name = contactName.value.trim() || \"WhatsApp Lead\";\n    const phone = contactPhone.value.trim();\n    if (!phone) {\n      setLeadStatus({\n        status: \"error\",\n        message: \"Phone number is required to send to Lead Inbox.\",\n        showActions: true,\n      });\n      return;\n    }\n    sendInboxButton.disabled = true;\n    createLeadButton.disabled = true;\n    setLeadStatus({ status: \"checking\", message: \"Sending to Lead Inbox...\", showActions: false });\n    const stageName = lastSummaryStages.find((stage) => stage.id === stageSelect.value)?.name;\n    const payload = {\n      name,\n      phone,\n      email: contactEmail.value.trim() || undefined,\n      company: contactCompany.value.trim() || undefined,\n      notes: `WhatsApp chat import for ${name}`,\n      preferredStage: stageName,\n    };\n    const res = await chrome.runtime.sendMessage({ type: \"CREATE_LEAD_INBOX\", payload });\n    if (!res?.ok) {\n      setLeadStatus({\n        status: \"error\",\n        message: res?.error || \"Unable to send to Lead Inbox.\",\n        showActions: true,\n      });\n      sendInboxButton.disabled = false;\n      createLeadButton.disabled = false;\n      return;\n    }\n    await refreshSummary();\n    sendInboxButton.disabled = false;\n    createLeadButton.disabled = false;\n  });\n\n  const setEmptyList = (container: HTMLElement, message: string) => {\n    container.innerHTML = `<div class=\"tw-wa-empty\">${message}</div>`;\n  };\n\n  const setLeadStatus = (params: {\n    status: \"idle\" | \"checking\" | \"lead\" | \"inbox\" | \"none\" | \"error\";\n    message: string;\n    showActions: boolean;\n  }) => {\n    leadStatusBody.textContent = params.message;\n    leadStatusActions.style.display = params.showActions ? \"flex\" : \"none\";\n    leadStatusPill.classList.remove(\"is-success\", \"is-warning\");\n    if (params.status === \"lead\") {\n      leadStatusPill.textContent = \"In CRM\";\n      leadStatusPill.classList.add(\"is-success\");\n    } else if (params.status === \"inbox\") {\n      leadStatusPill.textContent = \"In Lead Inbox\";\n      leadStatusPill.classList.add(\"is-warning\");\n    } else if (params.status === \"checking\") {\n      leadStatusPill.textContent = \"Checking\";\n    } else if (params.status === \"none\") {\n      leadStatusPill.textContent = \"Not Found\";\n    } else if (params.status === \"error\") {\n      leadStatusPill.textContent = \"Error\";\n    } else {\n      leadStatusPill.textContent = \"Idle\";\n    }\n  };\n\n  const updateContactFields = (payload: {\n    name?: string | null;\n    phone?: string | null;\n    email?: string | null;\n    company?: string | null;\n    stageId?: string | null;\n  }) => {\n    if (payload.name) contactName.value = payload.name;\n    if (payload.phone) contactPhone.value = payload.phone;\n    if (payload.email) contactEmail.value = payload.email;\n    if (payload.company) contactCompany.value = payload.company;\n    if (payload.stageId) stageSelect.value = payload.stageId;\n  };\n\n  const refreshLeadStatus = async () => {\n    const phone = contactPhone.value.trim();\n    if (!phone) {\n      lastLeadPhone = null;\n      setLeadStatus({\n        status: \"idle\",\n        message: \"Phone number not detected yet. Add it to check CRM status.\",\n        showActions: false,\n      });\n      return;\n    }\n    if (isCheckingLead && phone === lastLeadPhone) return;\n    isCheckingLead = true;\n    lastLeadPhone = phone;\n    setLeadStatus({ status: \"checking\", message: \"Checking CRM & Lead Inbox...\", showActions: false });\n    try {\n      const res = await chrome.runtime.sendMessage({\n        type: \"CONTACT_LOOKUP\",\n        payload: { phone },\n      });\n      if (!res?.ok) {\n        setLeadStatus({\n          status: \"error\",\n          message: res?.error || \"Unable to check CRM status.\",\n          showActions: false,\n        });\n        return;\n      }\n\n      const data = res?.data;\n      if (data?.status === \"lead\" && data?.lead) {\n        updateContactFields({\n          name: data.lead.name,\n          phone: data.lead.phone,\n          email: data.lead.email,\n          company: data.lead.company,\n          stageId: data.lead.stage?.id,\n        });\n        const stageLabel = data.lead.stage?.name ? `Stage: ${data.lead.stage.name}` : \"Stage assigned\";\n        setLeadStatus({\n          status: \"lead\",\n          message: `Already in Tynkwink CRM \u2022 ${stageLabel}`,\n          showActions: false,\n        });\n        return;\n      }\n\n      if (data?.status === \"inbox\" && data?.inbox) {\n        updateContactFields({\n          name: data.inbox.leadPreview?.name,\n          phone: data.inbox.leadPreview?.phone,\n          email: data.inbox.leadPreview?.email,\n          company: data.inbox.leadPreview?.company,\n        });\n        setLeadStatus({\n          status: \"inbox\",\n          message: `Lead Inbox (${data.inbox.status}) \u2022 Awaiting approval`,\n          showActions: false,\n        });\n        return;\n      }\n\n      setLeadStatus({\n        status: \"none\",\n        message: \"Not found in CRM or Lead Inbox. Create now or send for approval.\",\n        showActions: true,\n      });\n    } finally {\n      isCheckingLead = false;\n    }\n  };\n\n  const updateSummary = (summary: any) => {\n    if (!summary) return;\n    navAll.textContent = `All Chats (${summary.stats?.allChats ?? 0})`;\n    navUnread.textContent = `Unread Chats (${summary.stats?.unreadChats ?? 0})`;\n    navNeedsReply.textContent = `Needs Reply (${summary.stats?.needsReply ?? 0})`;\n    navGroups.textContent = `Groups (${summary.stats?.groups ?? 0})`;\n    navReminders.textContent = `Pending Reminders (${summary.stats?.pendingReminders ?? 0})`;\n\n    pipelineName.value = summary.pipeline?.name ?? \"Leads\";\n    const defaultStage =\n      summary.pipeline?.stages?.find((stage: any) => stage.id === summary.pipeline?.defaultStageId) ??\n      summary.pipeline?.stages?.[0];\n\n    stageSelect.innerHTML = \"\";\n    lastSummaryStages = (summary.pipeline?.stages ?? []).map((stage: any) => ({\n      id: stage.id,\n      name: stage.name ?? \"Stage\",\n    }));\n    lastSummaryStages.forEach((stage) => {\n      const option = document.createElement(\"option\");\n      option.value = stage.id;\n      option.textContent = stage.name ?? \"Stage\";\n      stageSelect.appendChild(option);\n    });\n    if (defaultStage?.id) {\n      stageSelect.value = defaultStage.id;\n    }\n\n    const isAiEnabled = Boolean(summary.features?.aiAutoReplyEnabled);\n    aiToggle.checked = isAiEnabled;\n    aiLabel.textContent = `(Global Switch: ${isAiEnabled ? \"on\" : \"off\"})`;\n\n    sourceName.value = \"Extension\";\n    contactEmail.value = summary.user?.email ?? contactEmail.value;\n\n    pipelineContainer.innerHTML = \"\";\n    const stages = summary.pipeline?.stages ?? [];\n    stages.forEach((stage: any) => {\n      const stageEl = document.createElement(\"div\");\n      stageEl.className = \"tw-wa-stage\";\n      stageEl.style.background = stage.color || \"#64748b\";\n      stageEl.innerHTML = `<strong>${stage.count ?? 0}</strong><span>${stage.name ?? \"Stage\"}</span>`;\n      pipelineContainer.appendChild(stageEl);\n    });\n\n    const reminders = summary.reminders ?? [];\n    reminderList.innerHTML = \"\";\n    if (reminders.length === 0) {\n      setEmptyList(reminderList, \"No reminders yet.\");\n    } else {\n      reminders.forEach((reminder: any) => {\n        const item = document.createElement(\"div\");\n        item.className = \"tw-wa-reminder-item\";\n        item.innerHTML = `\n          <input type=\"checkbox\" ${reminder?.done ? \"checked\" : \"\"} />\n          <label>${reminder?.title ?? \"Reminder\"}</label>\n        `;\n        reminderList.appendChild(item);\n      });\n    }\n\n    const quickReplies = summary.quickReplies ?? [];\n    quickList.innerHTML = \"\";\n    if (quickReplies.length === 0) {\n      setEmptyList(quickList, \"No quick replies configured.\");\n    } else {\n      quickReplies.forEach((reply: any) => {\n        const item = document.createElement(\"div\");\n        item.className = \"tw-wa-quick-item\";\n        item.innerHTML = `\n          <span>${reply?.title ?? \"Quick Reply\"}</span>\n          <span class=\"tw-wa-count-pill\">${reply?.count ?? 0}</span>\n        `;\n        quickList.appendChild(item);\n      });\n    }\n\n    const canSync = Boolean(summary.permissions?.canSync);\n    syncButtons.forEach((button) => {\n      const btn = button as HTMLButtonElement;\n      btn.disabled = !canSync;\n      btn.title = canSync ? \"\" : \"You do not have permission to sync.\";\n    });\n  };\n\n  const refreshSummary = async () => {\n    if (isLoadingSummary) return;\n    isLoadingSummary = true;\n    log.textContent = \"Loading CRM summary...\";\n    try {\n      const res = await opts.onGetSummary();\n      if (!res?.ok) {\n        log.textContent = res?.error || \"Unable to load CRM summary.\";\n        return;\n      }\n      updateSummary(res?.summary);\n      log.textContent = \"CRM summary synced.\";\n      refreshLeadStatus();\n    } finally {\n      isLoadingSummary = false;\n    }\n  };\n\n  const openModal = () => {\n    modal.classList.add(\"is-visible\");\n  };\n  const closeModal = () => {\n    modal.classList.remove(\"is-visible\");\n  };\n\n  loginBtn.onclick = () => openModal();\n  closeBtn.onclick = () => closeModal();\n\n  const setAuthState = (token: string | null) => {\n    if (token) {\n      authStatus.textContent = \"CRM Connected\";\n      loginBtn.textContent = \"Connected\";\n      loginBtn.disabled = true;\n      closeModal();\n    } else {\n      authStatus.textContent = \"Action needed: Log in to CRM\";\n      loginBtn.textContent = \"Login\";\n      loginBtn.disabled = false;\n      openModal();\n    }\n  };\n\n  (async () => {\n    ensureHeaderObserver();\n    setPanelCollapsed(false);\n    window.addEventListener(\"resize\", updateOverlayBounds);\n    setInterval(() => {\n      ensureHeaderObserver();\n      updateOverlayBounds();\n    }, 1000);\n    const res = await opts.onCheckAuth();\n    const token = res?.auth?.token ?? null;\n    setAuthState(token);\n    if (token) {\n      await refreshSummary();\n    }\n  })();\n\n  loginForm.onsubmit = async (event) => {\n    event.preventDefault();\n    if (isLoggingIn) return;\n    modalStatus.textContent = \"Signing in...\";\n    isLoggingIn = true;\n    loginBtn.disabled = true;\n    const formData = new FormData(loginForm);\n    const email = String(formData.get(\"email\") || \"\").trim();\n    const password = String(formData.get(\"password\") || \"\").trim();\n    const tenantId = (tenantSelect.style.display === \"none\" ? tenantInput.value : tenantSelect.value) || \"\";\n    const normalizedTenantId = tenantId.trim() || null;\n\n    const res = await opts.onLogin({ email, password, tenantId: normalizedTenantId });\n    if (!res?.ok) {\n      modalStatus.textContent = res?.error || \"Login failed.\";\n      isLoggingIn = false;\n      loginBtn.disabled = false;\n      return;\n    }\n\n    if (res?.requiresTenantSelection) {\n      const tenants = res.tenants || [];\n      if (tenants.length === 1) {\n        const followUp = await opts.onLogin({ email, password, tenantId: tenants[0].tenantId });\n        if (!followUp?.ok) {\n          modalStatus.textContent = followUp?.error || \"Login failed.\";\n          isLoggingIn = false;\n          loginBtn.disabled = false;\n          return;\n        }\n        modalStatus.textContent = \"Login successful. Credentials synced.\";\n        setAuthState(followUp?.auth?.token ?? null);\n        await refreshSummary();\n        isLoggingIn = false;\n        loginBtn.disabled = false;\n        return;\n      }\n      tenantInput.style.display = \"none\";\n      tenantSelect.style.display = \"block\";\n      tenantSelect.innerHTML = \"\";\n      for (const tenant of tenants) {\n        const option = document.createElement(\"option\");\n        option.value = tenant.tenantId;\n        option.textContent = `${tenant.tenantName} (${tenant.role})`;\n        tenantSelect.appendChild(option);\n      }\n      tenantSelect.value = tenantSelect.options[0]?.value ?? \"\";\n      modalStatus.textContent = \"Select a tenant to continue.\";\n      isLoggingIn = false;\n      loginBtn.disabled = false;\n      return;\n    }\n\n    modalStatus.textContent = \"Login successful. Credentials synced.\";\n    setAuthState(res?.auth?.token ?? null);\n    await refreshSummary();\n    isLoggingIn = false;\n    loginBtn.disabled = false;\n  };\n\n  syncButtons.forEach((button) => {\n    (button as HTMLButtonElement).onclick = async () => {\n      log.textContent = \"Syncing current chat...\";\n      try {\n        const res = await opts.onSync();\n        log.textContent = JSON.stringify(res, null, 2);\n        await refreshSummary();\n      } catch (error: any) {\n        log.textContent = `Sync failed: ${error?.message || \"unknown error\"}`;\n      }\n    };\n  });\n}\n", "import { mountOverlay } from \"./ui/overlay\";\nimport type { SyncPayload, WhatsAppMessage, Direction } from \"./common/types\";\n\nconst EXTRACTOR_VERSION = \"dom-v1\";\n\nfunction sleep(ms: number) {\n  return new Promise((r) => setTimeout(r, ms));\n}\n\n/**\n * IMPORTANT:\n * WhatsApp Web DOM changes frequently. These selectors are heuristic.\n * You will likely need to adjust logic here over time.\n */\nconst ignoredPresence = new Set([\"online\", \"typing...\", \"typing\u2026\", \"last seen\"]);\nconst phonePattern = /(\\+?\\d[\\d\\s().-]{6,}\\d)/;\n\nconst normalizePhone = (value: string | null | undefined) => {\n  if (!value) return null;\n  const match = value.match(phonePattern);\n  if (!match) return null;\n  let normalized = match[0].replace(/[^\\d+]/g, \"\");\n  if (normalized.startsWith(\"00\")) {\n    normalized = `+${normalized.slice(2)}`;\n  }\n  if (normalized.startsWith(\"+\")) {\n    normalized = `+${normalized.slice(1).replace(/\\D/g, \"\")}`;\n  } else {\n    normalized = normalized.replace(/\\D/g, \"\");\n  }\n  if (normalized.replace(/\\D/g, \"\").length < 7) return null;\n  return normalized;\n};\n\nconst extractTextCandidates = (root: Element | null) => {\n  if (!root) return [];\n  const candidates = new Set<string>();\n  const addCandidate = (value: string | null | undefined) => {\n    const trimmed = value?.trim();\n    if (!trimmed) return;\n    const lower = trimmed.toLowerCase();\n    if (ignoredPresence.has(lower)) return;\n    candidates.add(trimmed);\n  };\n\n  addCandidate(root.getAttribute(\"title\"));\n  addCandidate(root.getAttribute(\"aria-label\"));\n  root.querySelectorAll(\"span\").forEach((span) => addCandidate(span.textContent));\n  root.querySelectorAll<HTMLElement>(\"[title],[aria-label]\").forEach((node) => {\n    addCandidate(node.getAttribute(\"title\"));\n    addCandidate(node.getAttribute(\"aria-label\"));\n  });\n\n  return Array.from(candidates);\n};\n\nconst pickBestText = (candidates: string[]) => {\n  if (!candidates.length) return null;\n  return candidates.sort((a, b) => b.length - a.length)[0] || null;\n};\n\nfunction getChatTitle(): string {\n  // Strategy:\n  // 1) find a header area\n  // 2) choose the most prominent text node\n  const header = document.querySelector(\"header\");\n  const headerTitle = pickBestText(extractTextCandidates(header));\n  if (headerTitle) return headerTitle;\n\n  const selectedChat = document.querySelector('[aria-selected=\"true\"]');\n  const selectedTitle = pickBestText(extractTextCandidates(selectedChat));\n  return selectedTitle || \"Unknown\";\n}\n\n/**\n * Best-effort detection:\n * WhatsApp Web may not provide phone numbers in DOM reliably.\n * Treat phoneE164 as optional.\n */\nfunction getPhoneE164BestEffort(): string | null {\n  const header = document.querySelector(\"header\");\n  const selectedChat = document.querySelector('[aria-selected=\"true\"]');\n  const candidateSources = [\n    ...extractTextCandidates(header),\n    ...extractTextCandidates(selectedChat),\n  ];\n\n  for (const candidate of candidateSources) {\n    const normalized = normalizePhone(candidate);\n    if (normalized) return normalized;\n  }\n\n  const dataId =\n    selectedChat?.getAttribute(\"data-id\") || header?.getAttribute(\"data-id\") || selectedChat?.closest(\"[data-id]\")?.getAttribute(\"data-id\");\n  const dataIdPhone = normalizePhone(dataId);\n  if (dataIdPhone) return dataIdPhone;\n\n  try {\n    const url = new URL(location.href);\n    const phoneParam = normalizePhone(url.searchParams.get(\"phone\"));\n    if (phoneParam) return phoneParam;\n  } catch {\n    return null;\n  }\n\n  return null;\n}\n\n/**\n * Message extraction:\n * MVP extracts visible text nodes from message bubbles.\n * This is not perfect: it may capture extra UI texts.\n */\nfunction extractVisibleMessages(limit = 50): WhatsAppMessage[] {\n  // Primary region where messages are likely rendered\n  const main = document.querySelector(\"main\");\n  if (!main) return [];\n\n  // Try to capture message bubble text spans. WhatsApp often uses spans for text.\n  const spans = Array.from(main.querySelectorAll(\"span\"))\n    .map((n) => (n.textContent || \"\").trim())\n    .filter((t) => t.length > 0);\n\n  // Basic de-noising: remove very common UI artifacts\n  const noise = new Set([\"Search\", \"Type a message\", \"Today\", \"Yesterday\"]);\n  const cleaned = spans.filter((t) => !noise.has(t));\n\n  const recent = cleaned.slice(-limit);\n\n  // Direction inference is hard with naive DOM.\n  // Later you can infer using bubble alignment/classes.\n  const direction: Direction = \"unknown\";\n\n  return recent.map((text) => ({\n    text,\n    direction,\n    ts: null\n  }));\n}\n\nasync function buildPayload(): Promise<SyncPayload> {\n  const title = getChatTitle();\n  const isGroup = false; // CHANGE HERE: implement group detection if needed\n  const phoneE164 = getPhoneE164BestEffort();\n\n  const messages = extractVisibleMessages(50);\n\n  return {\n    contact: {\n      displayName: title || null,\n      phoneE164\n    },\n    chat: {\n      title: title || \"Unknown\",\n      isGroup\n    },\n    messages,\n    meta: {\n      pageUrl: location.href,\n      capturedAt: new Date().toISOString(),\n      extractorVersion: EXTRACTOR_VERSION\n    }\n  };\n}\n\nasync function syncCurrentChat() {\n  const payload = await buildPayload();\n  const res = await chrome.runtime.sendMessage({ type: \"SYNC_CHAT\", payload });\n  return res;\n}\n\nasync function checkAuth() {\n  const res = await chrome.runtime.sendMessage({ type: \"AUTH_GET\" });\n  return res;\n}\n\nasync function loginCrm(payload: { email: string; password: string; tenantId?: string | null }) {\n  const res = await chrome.runtime.sendMessage({ type: \"AUTH_LOGIN\", payload });\n  return res;\n}\n\nasync function loadSummary() {\n  const res = await chrome.runtime.sendMessage({ type: \"EXTENSION_SUMMARY\" });\n  return res;\n}\n\nfunction getChatSnapshot() {\n  return {\n    name: getChatTitle() || null,\n    phone: getPhoneE164BestEffort()\n  };\n}\n\n/**\n * WhatsApp Web is SPA; the DOM might not be ready immediately even at document_idle.\n * We mount overlay after main/header appear.\n */\nasync function init() {\n  for (let i = 0; i < 30; i++) {\n    const header = document.querySelector(\"header\");\n    const main = document.querySelector(\"main\");\n    if (header && main) break;\n    await sleep(500);\n  }\n\n  mountOverlay({\n    onSync: syncCurrentChat,\n    onCheckAuth: checkAuth,\n    onLogin: loginCrm,\n    onGetSummary: loadSummary,\n    onGetChatSnapshot: getChatSnapshot\n  });\n}\n\ninit();\n"],
  "mappings": ";AAQA,SAAS,GAA0C,KAAQ,QAAgC,CAAC,GAAG;AAC7F,QAAM,OAAO,SAAS,cAAc,GAAG;AACvC,aAAW,CAAC,GAAG,CAAC,KAAK,OAAO,QAAQ,KAAK,EAAG,MAAK,aAAa,GAAG,CAAC;AAClE,SAAO;AACT;AAEO,SAAS,aAAa,MAAmB;AAC9C,QAAM,KAAK;AACX,MAAI,SAAS,eAAe,EAAE,EAAG;AAEjC,WAAS,gBAAgB,UAAU,IAAI,sBAAsB;AAC7D,MAAI,SAAS,MAAM;AACjB,aAAS,KAAK,UAAU,IAAI,sBAAsB;AAAA,EACpD;AAEA,QAAM,OAAO,GAAG,KAAK;AACrB,OAAK,KAAK;AACV,OAAK,MAAM,WAAW;AACtB,OAAK,MAAM,QAAQ;AACnB,OAAK,MAAM,SAAS;AACpB,OAAK,MAAM,gBAAgB;AAC3B,OAAK,MAAM,aAAa;AAExB,OAAK,YAAY;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA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",
  "names": []
}
